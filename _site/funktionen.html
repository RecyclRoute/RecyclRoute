<!DOCTYPE html>
<html lang="de-CH">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" href="/RecyclRoute/assets/images/RecyclRoute_Logo_9E9E9E.png" type="image/x-icon">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Funktionen | RecylRoute</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Funktionen" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Webroutenberechung f√ºr Recyclingsammlungen" />
<meta property="og:description" content="Webroutenberechung f√ºr Recyclingsammlungen" />
<link rel="canonical" href="http://localhost:4000/RecyclRoute/funktionen.html" />
<meta property="og:url" content="http://localhost:4000/RecyclRoute/funktionen.html" />
<meta property="og:site_name" content="RecylRoute" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Funktionen" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Webroutenberechung f√ºr Recyclingsammlungen","headline":"Funktionen","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/RecyclRoute/Bilder/RecyclRoute_Logo.png"}},"url":"http://localhost:4000/RecyclRoute/funktionen.html"}</script>
<!-- End Jekyll SEO tag -->

  <link rel="stylesheet" href="/RecyclRoute/assets/css/style.css?v=">
  <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/RecyclRoute/favicon.ico" -->

<!-- end custom head snippets -->

</head>
<script>
document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll('pre > code').forEach(codeBlock => {
    const button = document.createElement('button');
    button.className = 'copy-button';
    button.type = 'button';
    button.innerText = 'üìã Kopieren';

    button.addEventListener('click', () => {
      navigator.clipboard.writeText(codeBlock.innerText).then(() => {
        button.innerText = '‚úÖ Kopiert!';
        setTimeout(() => (button.innerText = 'üìã Kopieren'), 2000);
      });
    });

    const pre = codeBlock.parentNode;
    pre.appendChild(button); // ‚¨Ö Button INS <pre> einf√ºgen, nicht davor
  });
});

</script>
<body>
    <header>
    
    <div class="header-content">
      <img src="/RecyclRoute/assets/images/RecyclRoute_Logo_9E9E9E.png" alt="Logo">
      <h2>
        <a href="/RecyclRoute/index.html" style="text-decoration: none; color: inherit;">
          RecyclRoute - Dokumentation RecyclRoute
        </a>
      </h2>
    </div>
    <nav>
      <ul>
        <li><a href="/RecyclRoute/einleitung.html">Einleitung</a></li>
        <li><a href="/RecyclRoute/installation.html">Installation</a></li>
        <li><a href="/RecyclRoute/konzept.html">Konzept</a></li>
        <li class="dropdown">
          <a href="/RecyclRoute/funktionen.html">Erkl√§rung der Funktionen</a>
          <div class="dropdown-content">
            <div><a href="/RecyclRoute/funktionen.html#startpage">Startpage</a></div>
            <div><a href="/RecyclRoute/funktionen.html#planer">Planner</a></div>
            <div><a href="/RecyclRoute/funktionen.html#report">Report</a></div>
          </div>
        </li>
        <li class="dropdown">
          <a href="/RecyclRoute/aufbauGDI.html">Aufbau GDI</a>
          <div class="dropdown-content">
            <div><a href="/RecyclRoute/aufbauGDI.html#Backend">Backend</a></div>
            <div><a href="/RecyclRoute/aufbauGDI.html#Grundlagedaten">Grundlagedaten</a></div>
            <div><a href="/RecyclRoute/aufbauGDI.html#datenbank-und-datenbankschema">Datenbank</a></div>
            <div><a href="/RecyclRoute/aufbauGDI.html#berechnungen">Berechnungen</a></div>
            <div><a href="/RecyclRoute/aufbauGDI.html#frontend">Frontend</a></div>
          </div>
        </li>
        <li><a href="/RecyclRoute/ausblick.html">Erweiterungsm√∂glichkeiten</a></li>
      </ul>
    </nav>
  </header>
  <main class="content">
    <h1 id="erkl√§rung-der-funktionen-von-recyclroute">Erkl√§rung der Funktionen von RecyclRoute</h1>
<p><a id="top"></a>
In diesem Abschnitt werden die Funktionen und Interaktionen der RecyclRoute beschrieben.</p>

<h1 id="startpage">Startpage</h1>
<div id="startpage"></div>
<p>Auf der Startseite muss man sich bereits ein erstesmal entscheiden was man machen m√∂chte. Wenn man Papier- oder Kartonsammlungen organisieren oder deine Route planen m√∂chtest, muss man auf Planner klicken. Wenn du nicht abgeholtes oder falsch deponiertes Material melden m√∂chtest, muss man auf Report klicken. Dann wird man dementsprechend auf die Seite mit den Entsprechenden Seiten geleitet. Die Farbe soll dabei auch gleich aufzeigen wo man ist. So ist der Planner in Gr√ºnt√∂nen gehalten w√§rend der Report in Braun gehalten ist. Beides so, dass es doch auch das man es mit Recycling, Umwelt und √ñkologischen Themen direkt assoziert.
<img src="Bilder/Startpage_1.png" alt="Startseite" /></p>

<h2 id="funktionen-planer">Funktionen Planer:</h2>

<h3 id="projekt-erstellen">Projekt erstellen</h3>

<h4 id="berechnungsalgorithmus">Berechnungsalgorithmus</h4>
<div id="berechnungsalgorithmus"></div>

<p><strong>Routing- und Optimierungs-Tool f√ºr vollst√§ndige Wegenetzbefahrung</strong></p>

<p><strong>Zweck</strong></p>

<p>Das ganze ist in einem Python-Skript aufgebaut und soll automatisiert eine optimale Route durch ein definiertes Strassennetz berechnen. Ziel ist es, alle relevanten Strassen in einem Gebiet m√∂glichst effizient und ohne doppelte Befahrung abzufahren ‚Äì √§hnlich zum sogenannten Chinese Postman Problem welches eher Bekannt ist.</p>

<p><strong>Eingaben</strong></p>

<p>Als Eingaben von der App zum das Skript auszuf√ºhren folgende Daten ben√∂tigt:</p>

<ul>
  <li>Ein JSON welches das Polygon definiert</li>
  <li>Ein Geopackage Datei welche mit einem Weiteren Skript vorbereitet werden muss (Preprocessing) und enth√§lt die Geometrien und Eigenschaften der Strassenachsen</li>
  <li>Die Startkoordinaten welche den Ausgangspunkt der Route dienen</li>
</ul>

<p><strong>Ausgaben</strong></p>

<p>Als Ausgabe werden mehrere Dateien welche verwendet werden k√∂nnen / in Zukunft verwendet werden k√∂nnten.</p>
<ul>
  <li>eine Datei mit der gesamten berechneten Route als GeoJSON</li>
  <li>Eine Datei mit Navigationsanweisungen</li>
</ul>

<p><strong>Verwendete Module</strong></p>

<p>Das Skript verwendet unter anderem folgende Python-Bibliotheken:</p>

<ul>
  <li>
    <p>F√ºr Geodatenverarbeitung: geopandas, shapely, pyproj, networkx</p>
  </li>
  <li>
    <p>F√ºr numerische und graphentheoretische Operationen: numpy, scipy.spatial.cKDTree</p>
  </li>
  <li>
    <p>F√ºr Optimierung: ortools (Google OR-Tools)</p>
  </li>
  <li>
    <p>F√ºr Routing-Anfragen: requests in Verbindung mit einer lokalen Valhalla-Instanz</p>
  </li>
  <li>
    <p>F√ºr allgemeine Dateiverarbeitung: json, os</p>
  </li>
</ul>

<p><strong>Ablauf und Mathematische Grundlagen</strong></p>

<p>Zun√§chst werden die Startkoordinaten vom Koordinatensystem EPSG:3857 (verwendet aufgrund der von <strong>Open Layers</strong>) in das Schweizer Landeskoordinatensystem EPSG:2056 transformiert. Anschliessend wird das Strassennetz im Zielgebiet aufbereitet.</p>

<p>Die Aufbereitung erfolgt durch Einlesen des GeoPackage-Layers und Filtern irrelevanter bzw. unzul√§ssiger Strassen. Dabei werden folgende Eigenschaften ausgeschlossen:</p>

<p>Objektarten wie: Ausfahrt, Einfahrt, Autobahn, Rastst√§tte, Zufahrt, Dienstzufahrt, Autozug, F√§hre, Autostrasse, Klettersteig, Provisorium</p>

<ul>
  <li>
    <p>Wanderwegtypen wie: Wanderweg, Bergwanderweg, Alpinwanderweg sowie andere</p>
  </li>
  <li>
    <p>Verkehrsbeschr√§nkungen wie: Allgemeines Fahrverbot, Fussweg, Fussg√§ngerzone, Geb√ºhrenpflichtig, Gesicherte Kletterpartie, Milit√§rstrasse, Radweg, Radweg und Fussweg, Reitweg, Reitweg und Fussweg, Rennstrecke, Panzerpiste, Teststrecke, Allgemeine Verkehrsbeschr√§nkung, Gesperrt</p>
  </li>
  <li>
    <p>Belagsarten wie: Natur</p>
  </li>
</ul>

<p>Danach werden die Liniengeometrien der verbleibenden Strassen analysiert. Einzelne Punkte entlang der Linien werden mittels Punkt-Snapping zusammengef√ºhrt, falls sie sich innerhalb einer bestimmten Toleranz (0.5 Meter) befinden. Gerade Strassenabschnitte, die einen Winkel von mehr als 170 Grad zwischen den Segmenten aufweisen, werden automatisch zusammengef√ºhrt.</p>

<p>Aus diesen Segmenten wird ein ungerichteter Multigraph erzeugt, in dem die Punkte als Knoten und die Strassenabschnitte als Kanten dargestellt sind. Danach werden zu kleine oder isolierte Komponenten (weniger als drei Knoten) entfernt.</p>

<p>Mit diesem Graphen wird danach das Chinese Postman Problem gel√∂st. Dazu werden alle Knoten mit ungeradem Knotengrad identifiziert. Diese Knoten werden paarweise so verbunden, dass die zus√§tzlichen Verbindungen eine minimale Gesamtl√§nge haben. Diese Minimierung erfolgt durch eine Paarung via gewichteter Matching-Optimierung. Der resultierende Graph enth√§lt ausschliesslich gerade Knotengrade und ist daher eulerisierbar ‚Äì ein Eulerkreis kann gefunden werden, der alle Kanten exakt einmal durchl√§uft. Der Pfad wird mit dem Hierholzer-Algorithmus berechnet, beginnend beim der Startposition am n√§chstgelegenen Knoten.</p>

<p>Optional kann die erzeugte Koordinatenfolge noch gefiltert werden, um Punkte mit zu geringem Abstand (z.‚ÄØB. unter 10 Metern) zu entfernen. Dieser Schritt ist jedoch standardm√§ssig deaktiviert.</p>

<p>F√ºr die weitere Optimierung wird eine Distanzmatrix aufgebaut, welche die realen Wegstrecken zwischen allen Koordinaten enth√§lt. Diese Distanzen werden nicht als Luftlinie, sondern √ºber Valhalla als echte Reisewege berechnet. Dabei erkennt das Skript automatisch, ob Auto- oder Fuss-Routing verwendet werden muss, da dies nicht zwingend Identisch sein muss wie die Daten welche aus dem gpkg SwissTLM3D bezogen wurden. Die Matrixberechnung erfolgt parallelisiert mit mehreren Threads.</p>

<p>Mit dieser Distanzmatrix wird auf eine Art das Traveling Salesman Problem (TSP) gel√∂st ‚Äì also die Reihenfolge bestimmt, in der die Punkte mit geringster Gesamtreisel√§nge besucht werden. Dies geschieht mithilfe der Google OR-Tools mit der Strategie ‚ÄûPfad mit geringstem Startbogen‚Äú.</p>

<p>Im letzten Schritt werden die optimierten Koordinaten in Teilbl√∂cke unterteilt und jeweils bei Valhalla (selber gehostet) angefragt, um echte turn-by-turn-Navigationen zu erhalten. Pro Block werden JSON- und GeoJSON-Dateien erzeugt. Diese werden zu einer Gesamtroute zusammengef√ºgt und als finale GeoJSON-Datei gespeichert. Parallel dazu werden detaillierte Navigationsanweisungen in ausgegeben.</p>

<h2 id="funktionen-report">Funktionen Report:</h2>

<h2 id="funktionen-allgemein">Funktionen allgemein:</h2>
<ul>
  <li>X</li>
  <li>Y</li>
  <li>
    <p>Z</p>
  </li>
  <li>M√∂glichkeit das GNSS des Ger√§tes zur Standortlokalisation zu nutzen</li>
</ul>

<p><a href="#top">‚Üë Zur√ºck zum Beginn der Webseite</a></p>

<div style="display: flex; justify-content: space-between;">
  <div>
    <a href="einleitung.html">‚Üê Einleitung</a>
  </div>
  <div>
    <a href="aufbauGDI.html">Aufbau GDI ‚Üí</a>
  </div>
</div>

  </main>
  <footer>
    <p>
        ¬© RecylRoute - 2025 |
        <a href="https://github.com/RecyclRoute/RecyclRoute">GitHub Projektseite</a>
         |
        <small>Hosted on GitHub Pages ‚Äî Theme by <a href="https://github.com/orderedlist">orderedlist</a></small>
    </p>
  </footer>

  <script src="/RecyclRoute/assets/js/scale.fix.js"></script>
</body>
</html>
