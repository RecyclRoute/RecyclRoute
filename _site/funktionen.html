<!DOCTYPE html>
<html lang="de-CH">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" href="/RecyclRoute/assets/images/RecyclRoute_Logo_9E9E9E.png" type="image/x-icon">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Funktionen | RecylRoute</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Funktionen" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Webroutenberechung f√ºr Recyclingsammlungen" />
<meta property="og:description" content="Webroutenberechung f√ºr Recyclingsammlungen" />
<link rel="canonical" href="http://localhost:4000/RecyclRoute/funktionen.html" />
<meta property="og:url" content="http://localhost:4000/RecyclRoute/funktionen.html" />
<meta property="og:site_name" content="RecylRoute" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Funktionen" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Webroutenberechung f√ºr Recyclingsammlungen","headline":"Funktionen","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/RecyclRoute/Bilder/RecyclRoute_Logo.png"}},"url":"http://localhost:4000/RecyclRoute/funktionen.html"}</script>
<!-- End Jekyll SEO tag -->

  <link rel="stylesheet" href="/RecyclRoute/assets/css/style.css?v=">
  <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/RecyclRoute/favicon.ico" -->

<!-- end custom head snippets -->

</head>
<script>
document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll('pre > code').forEach(codeBlock => {
    const button = document.createElement('button');
    button.className = 'copy-button';
    button.type = 'button';
    button.innerText = 'üìã Kopieren';

    button.addEventListener('click', () => {
      navigator.clipboard.writeText(codeBlock.innerText).then(() => {
        button.innerText = '‚úÖ Kopiert!';
        setTimeout(() => (button.innerText = 'üìã Kopieren'), 2000);
      });
    });

    const pre = codeBlock.parentNode;
    pre.appendChild(button);
  });
});

</script>
<body>
    <header>
    
    <div class="header-content">
      <img src="/RecyclRoute/assets/images/RecyclRoute_Logo_9E9E9E.png" alt="Logo">
      <h2>
        <a href="/RecyclRoute/index.html" style="text-decoration: none; color: inherit;">
          RecyclRoute - Dokumentation RecyclRoute
        </a>
      </h2>
    </div>
    <nav>
      <ul>
        <li><a href="/RecyclRoute/einleitung.html">Einleitung</a></li>
         <li class="dropdown">
          <a href="/RecyclRoute/Installation.html">Installation</a>
          <div class="dropdown-content">
            <div><a href="/RecyclRoute/Installation.html#starten-der-anwendung">Starten der Applikation</a></div>
        </li>
        <li><a href="/RecyclRoute/konzept.html">Konzept</a></li>
        <li class="dropdown">
          <a href="/RecyclRoute/funktionen.html">Erkl√§rung der Funktionen</a>
          <div class="dropdown-content">
            <div><a href="/RecyclRoute/funktionen.html#startpage">Startpage</a></div>
            <div><a href="/RecyclRoute/funktionen.html#funktionen-report">Planner</a></div>
            <div><a href="/RecyclRoute/funktionen.html#funktionen-planner">Report</a></div>
            <div><a href="/RecyclRoute/funktionen.html#berechnungsalgorithmus">Routenberechnung</a></div>
          </div>
        </li>
        <li class="dropdown">
          <a href="/RecyclRoute/aufbauGDI.html">Aufbau GDI</a>
          <div class="dropdown-content">
            <div><a href="/RecyclRoute/aufbauGDI.html#Backend">Backend</a></div>
            <div><a href="/RecyclRoute/aufbauGDI.html#Grundlagedaten">Grundlagedaten</a></div>
            <div><a href="/RecyclRoute/aufbauGDI.html#datenbank-und-datenbankschema">Datenbank</a></div>
            <div><a href="/RecyclRoute/aufbauGDI.html#berechnungen">Berechnungen</a></div>
            <div><a href="/RecyclRoute/aufbauGDI.html#frontend">Frontend</a></div>
          </div>
        </li>
        <li><a href="/RecyclRoute/ausblick.html">Erweiterungsm√∂glichkeiten</a></li>
      </ul>
    </nav>
  </header>
  <main class="content">
    <h1 id="erkl√§rung-der-funktionen-von-recyclroute">Erkl√§rung der Funktionen von RecyclRoute</h1>
<p><a id="top"></a>
In diesem Abschnitt werden die Funktionen und Interaktionen der RecyclRoute beschrieben.</p>

<h1 id="startpage">Startpage</h1>
<div id="startpage"></div>
<p>Auf der Startseite muss man sich bereits ein erstesmal entscheiden was man machen m√∂chte. Wenn man Papier- oder Kartonsammlungen organisieren oder deine Route planen m√∂chtest, muss man auf Planner klicken. Wenn du nicht abgeholtes oder falsch deponiertes Material melden m√∂chtest, muss man auf Report klicken. Dann wird man dementsprechend auf die Seite mit den Entsprechenden Seiten geleitet.</p>

<p><img src="assets/images/Startpage_1.png" alt="Startseite" style="max-width: 75%; height: auto;" /></p>

<h1 id="funktionen-report">Funktionen Report:</h1>
<p>Nach dem Klicken auf Report wird man auf die Report Seite (braunt√∂ne) weitergeleitet. Auf welcher die Standartfunktionen GNSS, Norden der Karte, Anzeigen der Punkte des Projektes funktionieren, sowie der Report erstellen.
<img src="assets/gifs/report_page.gif" alt="Startseite Report" style="max-width: 75%; height: auto;" /></p>

<h2 id="report-erstellen">Report erstellen</h2>
<p>Mit dem klicken auf den Button unten rechts, kann ein neuer Report erstellt werden. Dazu muss vorab aber schon ein Projekt erstellt worden sein, damit man auch den Report auch einem Projekt zuweisen kann. Mit ausw√§hlen des Projektes einer Bemerkung (nur Dropdown m√∂glichkeiten) ein Datum eingegeben werden sowie ein Foto hochgeladen werden. Ebenso muss zwingend ein Punkt abgesetzt werden mit klicken auf die Karte. Dieser kann verschoben werden durch nochmaliges klicken. Mit Punkt speichern wird der Punkt in die Datenbank gespeichert und das Popup schliesst sich automatisch.</p>

<p><img src="assets/gifs/report_erstellen.gif" alt="Report erstellen" style="max-width: 75%; height: auto;" /></p>

<h1 id="funktionen-allgemein">Funktionen allgemein:</h1>
<p>Folgende drei Funktionen sind sowohl im Report als auch im Planner enthalten:</p>

<h2 id="reportpunkte-des-projektes-anzeigen">Reportpunkte des Projektes anzeigen</h2>
<p>Damit kann ein Projekt ausgew√§hlt werden und alle dem Projekt zugeordneten Projektpunkte angezeigt werden.</p>

<p><img src="assets/gifs/projektpunkte.gif" alt="Projektpunkte einblenden" style="max-width: 75%; height: auto;" /></p>

<h2 id="aktueller-standort-anzeigen">Aktueller Standort anzeigen</h2>
<p>Mit der Funktion wird die GNSS Position des Ger√§tes abgegriffen, wenn eingeschalten &amp; die Karte Zoom auf diesen Standort und zeigt die Position als Blauen Marker.</p>

<p><img src="assets/GIFs/GNSS_Punkt.gif" alt="GNSS" style="max-width: 75%; height: auto;" /></p>

<h2 id="karte-nach-norden-ausrichten">Karte nach Norden ausrichten</h2>
<p>Mit dieser Funktion kann die Karte wieder nach Norden ausgerichtet werden wenn die Karte verdreht ist.</p>

<p><img src="assets/GIFs/north.gif" alt="Norden" style="max-width: 75%; height: auto;" /></p>

<h1 id="funktionen-planner">Funktionen Planner:</h1>
<p>Nach dem Klicken auf Planner wird man auf die Planner Seite (gr√ºnt√∂ne) weitergeleitet. Auf welcher die Standartfunktionen GNSS, Norden der Karte, Anzeigen der Punkte des Projektes sowie das Planen der Route sowie das Managen der Projekte implementiert ist.</p>

<p><img src="assets/gifs/planner_page.gif.gif" alt="Startseite Planer" style="max-width: 75%; height: auto;" /></p>

<h2 id="projektmanager">Projektmanager</h2>
<p>Um den Projektmanager abzurufen, kann auf den Button unten rechts geklickt werden. Sobald dieser gestartet ist sieht man alle Projekte welche in der DB gespecihert sind. Durch klicken auf ein bestimmtes Projekt kommt ein weiteres Popup, welches vier Buttons aufweist und als Titel die Projektbezeichnung enth√§lt.</p>

<ul>
  <li>Route berechnen; damit kann die Route des Projektes neugerechnet werden</li>
  <li>Routing starten; damit kann man wenn ein Routing vorhanden ist dieses starten</li>
  <li>Statistiken; damit k√∂nnen Statistiken abgerufen werden</li>
  <li>Projekt l√∂schen; damit kann das Projekt aus der DB gel√∂scht werden.</li>
</ul>

<p>Mit dem kleinen x kann man den Projektmanager wieder schliessen.</p>

<p><img src="assets/GIFs/projektmanager.gif" alt="Projektmanager" style="max-width: 75%; height: auto;" /></p>

<h3 id="neues-projekt-erstellen">Neues Projekt erstellen</h3>
<p>Im Projektmanager ganz unten gibt es den Button <strong>Neues Projekt erstellen</strong>. Damit kann ein neues Projekt erstellt werden. Es erscheint ein neues Popup, in welchem man den Projektnamen, die Gemeinde, sowie ein Sammeldatum ausw√§hlen kann.</p>

<p><img src="assets/GIFs/neues_projekt.gif" alt="neues Projekt" style="max-width: 75%; height: auto;" /></p>

<h3 id="polygon-definieren--startpunkt-setzen">Polygon definieren &amp; Startpunkt setzen</h3>
<p>Mit klick auf <strong>Weiter</strong> best√§tigt man die Eingaben und man kommt auf die Karte wo man ein Polygon definieren muss welches das ganze Gebiet exakt umschliesst. Mit Doppelklick oder klick auf den Button <strong>Perimeter speichern</strong> best√§tigt man die Eingabe. Danach muss man noch der Startpunkt der Routensammlung definieren durch klicken auf einen Standort innerhalb des gew√§hlten Polygons.</p>

<p><img src="assets/GIFs/polygon_definieren.gif" alt="Polygon_definieren" style="max-width: 75%; height: auto;" /></p>

<p>Anschliessend kommt eine Meldung, dass die Berechnung der Route im Hintergrund passiert und man sobald die Route berechnet wurde weiter geleitet zur Navigation wird.</p>

<h3 id="berechnungsalgorithmus">Berechnungsalgorithmus</h3>
<div id="berechnungsalgorithmus"></div>
<p>Nachfolgend ist der ganze Berechnungsalgorithmus erkl√§rt, wie er aufgebaut ist. Zuerst werden grundlegende Punkte erkl√§rt und anschliessend der Ablauf und die theoretischen Grundlagen dahinter versucht zuerl√§utern.</p>

<h4 id="routing--und-optimierungs-tool-f√ºr-vollst√§ndige-wegenetzbefahrung"><strong>Routing- und Optimierungs-Tool f√ºr vollst√§ndige Wegenetzbefahrung</strong></h4>

<p>Das ganze ist in einem Python-Skript aufgebaut und soll automatisiert eine optimale Route durch ein definiertes Strassennetz berechnen. Ziel ist es, alle relevanten Strassen in einem Gebiet m√∂glichst effizient und ohne doppelte Befahrung abzufahren ‚Äì √§hnlich zum sogenannten Chinese Postman Problem welches eher Bekannt ist.</p>

<p><strong>Eingaben</strong></p>

<p>Als Eingaben von der App zum das Skript auszuf√ºhren folgende Daten ben√∂tigt:</p>

<ul>
  <li>Ein JSON welches das Polygon definiert</li>
  <li>Ein Geopackage Datei welche mit einem Weiteren Skript vorbereitet werden muss (Preprocessing) und enth√§lt die Geometrien und Eigenschaften der Strassenachsen</li>
  <li>Die Startkoordinaten welche den Ausgangspunkt der Route dienen</li>
</ul>

<p><strong>Ausgaben</strong></p>

<p>Als Ausgabe werden mehrere Dateien welche verwendet werden k√∂nnen / in Zukunft verwendet werden k√∂nnten.</p>
<ul>
  <li>eine Datei mit der gesamten berechneten Route als GeoJSON</li>
  <li>Eine Datei mit Navigationsanweisungen</li>
</ul>

<p><strong>Verwendete Module</strong></p>

<p>Das Skript verwendet unter anderem folgende Python-Bibliotheken:</p>

<ul>
  <li>
    <p>F√ºr Geodatenverarbeitung: geopandas, shapely, pyproj, networkx</p>
  </li>
  <li>
    <p>F√ºr numerische und graphentheoretische Operationen: numpy, scipy.spatial.cKDTree</p>
  </li>
  <li>
    <p>F√ºr Optimierung: ortools (Google OR-Tools)</p>
  </li>
  <li>
    <p>F√ºr Routing-Anfragen: requests in Verbindung mit einer lokalen Valhalla-Instanz</p>
  </li>
  <li>
    <p>F√ºr allgemeine Dateiverarbeitung: json, os</p>
  </li>
</ul>

<p><strong>Ablauf und Theoretischen Grundlagen</strong></p>

<p>Zun√§chst werden die Startkoordinaten vom Koordinatensystem EPSG:3857 (Standart von <strong>Open Layers</strong>) in das Schweizer Landeskoordinatensystem EPSG:2056 transformiert. Anschliessend wird das Strassennetz im Zielgebiet aufbereitet.</p>

<p>Die Aufbereitung erfolgt durch Einlesen des GeoPackage-Layers und Filtern irrelevanter bzw. unzul√§ssiger Strassen. Dabei werden folgende Eigenschaften ausgeschlossen:</p>

<p>Objektarten wie: Ausfahrt, Einfahrt, Autobahn, Rastst√§tte, Zufahrt, Dienstzufahrt, Autozug, F√§hre, Autostrasse, Klettersteig, Provisorium</p>

<ul>
  <li>
    <p>Wanderwegtypen wie: Wanderweg, Bergwanderweg, Alpinwanderweg sowie andere</p>
  </li>
  <li>
    <p>Verkehrsbeschr√§nkungen wie: Allgemeines Fahrverbot, Fussweg, Fussg√§ngerzone, Geb√ºhrenpflichtig, Gesicherte Kletterpartie, Milit√§rstrasse, Radweg, Radweg und Fussweg, Reitweg, Reitweg und Fussweg, Rennstrecke, Panzerpiste, Teststrecke, Allgemeine Verkehrsbeschr√§nkung, Gesperrt</p>
  </li>
  <li>
    <p>Belagsarten wie: Natur</p>
  </li>
</ul>

<p>Danach werden die Liniengeometrien der verbleibenden Strassen analysiert. Einzelne Punkte entlang der Linien werden mittels Punkt-Snapping zusammengef√ºhrt, falls sie sich innerhalb einer bestimmten Toleranz (0.5 Meter) befinden. Gerade Strassenabschnitte, die einen Winkel von mehr als 170 Grad zwischen den Segmenten aufweisen, werden automatisch zusammengef√ºhrt.</p>

<p>Aus diesen Segmenten wird ein ungerichteter Multigraph erzeugt, in dem die Punkte als Knoten und die Strassenabschnitte als Kanten dargestellt sind. Danach werden zu kleine oder isolierte Komponenten (weniger als drei Knoten) entfernt.</p>

<p>Mit diesem Graphen wird danach auf eine Art das Chinese Postman Problem angegangen. Dazu werden alle Knoten mit ungeradem Knotengrad identifiziert. Diese Knoten werden paarweise so verbunden, dass die zus√§tzlichen Verbindungen eine minimale Gesamtl√§nge haben. Diese Minimierung erfolgt durch eine Paarung via gewichteter Matching-Optimierung. Der resultierende Graph enth√§lt ausschliesslich gerade Knotengrade und ist daher eulerisierbar ‚Äì ein Eulerkreis kann gefunden werden, der alle Kanten exakt einmal durchl√§uft. Der Pfad wird mit dem Hierholzer-Algorithmus berechnet, beginnend beim der Startposition am n√§chstgelegenen Knoten.</p>

<p>Optional kann die erzeugte Koordinatenfolge noch gefiltert werden, um Punkte mit zu geringem Abstand (z.‚ÄØB. unter 10 Metern) zu entfernen. Dieser Schritt ist jedoch standardm√§ssig deaktiviert.</p>

<p>F√ºr die weitere Optimierung wird eine Distanzmatrix aufgebaut, welche die realen Wegstrecken zwischen allen Koordinaten enth√§lt. Diese Distanzen werden nicht als Luftlinie, sondern √ºber Valhalla als echte Reisewege berechnet. Dabei erkennt das Skript automatisch, ob Auto- oder Fuss-Routing verwendet werden muss, da dies nicht zwingend Identisch sein muss wie die Daten welche aus dem gpkg SwissTLM3D bezogen wurden. Die Matrixberechnung erfolgt parallelisiert mit mehreren Threads.</p>

<p>Mit dieser Distanzmatrix wird auf eine Art das Traveling Salesman Problem (TSP) gel√∂st ‚Äì also die Reihenfolge bestimmt, in der die Punkte mit geringster Gesamtreisel√§nge besucht werden. Dies geschieht mithilfe der Google OR-Tools mit der Strategie ‚ÄûPfad mit geringstem Startbogen‚Äú.</p>

<p>Im letzten Schritt werden die optimierten Koordinaten in Teilbl√∂cke unterteilt und jeweils bei Valhalla (selber gehostet) angefragt, um echte turn-by-turn Navigationen zu erhalten. Pro Block werden JSON- und GeoJSON-Dateien erzeugt. Diese werden zu einer Gesamtroute zusammengef√ºgt und als finale GeoJSON-Datei gespeichert. Parallel dazu werden detaillierte Navigationsanweisungen in ausgegeben.</p>

<p><a href="#top">‚Üë Zur√ºck zum Beginn der Webseite</a></p>

<div style="display: flex; justify-content: space-between;">
  <div>
    <a href="konzept.html">‚Üê Konzept</a>
  </div>
  <div>
    <a href="aufbauGDI.html">Aufbau GDI ‚Üí</a>
  </div>
</div>

  </main>
  <footer>
    <p>
        ¬© RecylRoute - 2025 |
        <a href="https://github.com/RecyclRoute/RecyclRoute">GitHub Projektseite</a>
         |
        <small>Hosted on GitHub Pages</small>
    </p>
  </footer>

  <script src="/RecyclRoute/assets/js/scale.fix.js"></script>
</body>
</html>
